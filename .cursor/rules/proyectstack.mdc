# Stack TecnolÃ³gico - Agenda de Citas

## ğŸ—ï¸ Arquitectura General
- **Frontend**: React 19.1.0 con Vite 7.0.0
- **Backend**: Node.js con Express.js
- **Base de Datos**: MySQL (MariaDB)
- **Package Manager**: pnpm
- **AutenticaciÃ³n**: JWT (JSON Web Tokens)

## ğŸ¯ Frontend Stack

### Core Technologies
- **React**: 19.1.0 (Functional Components + Hooks)
- **Vite**: 7.0.0 (Build tool y dev server)
- **React Router**: 7.6.3 (NavegaciÃ³n)
- **Material-UI**: 7.2.0 (Componentes UI)
- **Emotion**: 11.14.0 (Styling)

### Estructura de Componentes (Atomic Design)
```
frontend/src/components/
â”œâ”€â”€ atoms/          # Componentes bÃ¡sicos (Button, Input, etc.)
â”œâ”€â”€ molecules/      # Combinaciones de Ã¡tomos (FormField, Card, etc.)
â”œâ”€â”€ organisms/      # Componentes complejos (Forms, Tables, etc.)
â”œâ”€â”€ templates/      # Layouts (DashboardLayout, etc.)
â””â”€â”€ pages/          # PÃ¡ginas completas
```

### Styling
- **CSS Modules**: Para estilos scoped
- **Variables CSS**: Sistema de design tokens
- **Mobile First**: Responsive design
- **Convenciones**: camelCase para class names

### Estado y Data Fetching
- **React Hooks**: useState, useEffect, useContext
- **Custom Hooks**: useForm, useDoctor, InactivityHandler
- **Context API**: DoctorContext, ViewModeContext
- **Fetch API**: Para comunicaciÃ³n con backend

## ğŸ”§ Backend Stack

### Core Technologies
- **Node.js**: Runtime JavaScript
- **Express.js**: Framework web
- **MySQL**: Base de datos relacional
- **JWT**: AutenticaciÃ³n y autorizaciÃ³n

### Estructura del Backend
```
backend/
â”œâ”€â”€ config/         # ConfiguraciÃ³n de BD
â”œâ”€â”€ controllers/    # LÃ³gica de negocio
â”œâ”€â”€ middleware/     # Auth, validaciÃ³n, etc.
â”œâ”€â”€ models/         # Modelos de datos
â”œâ”€â”€ routes/         # DefiniciÃ³n de endpoints
â”œâ”€â”€ services/       # Servicios de negocio
â”œâ”€â”€ utils/          # Utilidades
â””â”€â”€ filters/        # Filtros y validaciÃ³n
```

### Middleware y ValidaciÃ³n
- **Joi**: ValidaciÃ³n de esquemas
- **Express Validator**: ValidaciÃ³n de requests
- **Custom Middleware**: Auth, roles, paginaciÃ³n

### Base de Datos
- **MySQL/MariaDB**: Base de datos principal
- **Connection Pooling**: Para optimizaciÃ³n
- **Migrations**: Scripts SQL para cambios de esquema

## ğŸ” AutenticaciÃ³n y AutorizaciÃ³n

### Roles de Usuario
- **admin**: Acceso completo al sistema
- **doctor**: GestiÃ³n de citas y pacientes
- **secretary**: GestiÃ³n de citas y pacientes

### JWT Implementation
- **Access Tokens**: Para autenticaciÃ³n
- **Role-based Access**: Control de permisos
- **Token Refresh**: RenovaciÃ³n automÃ¡tica

## ğŸ“Š Base de Datos

### Credenciales
- **Usuario**: jmro
- **ContraseÃ±a**: jmro1975
- **Base de datos**: agenda_citas
- **Host**: localhost
- **Puerto**: 3306

### Tablas Principales
- `users`: Usuarios del sistema
- `patients`: Pacientes
- `doctors`: Doctores
- `appointments`: Citas
- `doctor_consultation_hours`: Horarios de consulta
- `health_insurances`: Obras sociales
- `patient_references`: Personas de referencia

## ğŸš€ Desarrollo y Deployment

### âš ï¸ REGLAS IMPORTANTES DE DESARROLLO
- **yo me encargo de arrancar el script que crea los server de backend y frontend**
- **tu a cada cambio de codigo no debes hacer nada**
- **los servidores se reinician a cada cambio de codigo y hace que se tenga siempre la nueva version corriendo**
- **âš ï¸ NUNCA usar start-app.sh (autorestart ya configurado)**
- **el servidor siempre esta en marcha y se reinicia a cada cambio, no hacer un arranque nuevo**
- **NO hacer `cd frontend && pnpm dev`**
- **NO hacer `cd backend && node index.js`**
- **NO hacer `cd backend && pnpm dev`**
```

### URLs de Desarrollo
- **Frontend**: http://localhost:3000
- **Backend**: http://localhost:3001
- **API Base**: http://localhost:3001/api

### Testing API
```bash
# Login como admin
POST http://localhost:3001/api/auth/login
Content-Type: application/json

{
  "email": "admin@mail.com",
  "password": "Admin1234"
}
```

## ğŸ¨ Convenciones de CÃ³digo

### JavaScript/React
- **ES Modules**: import/export
- **Functional Components**: Con Hooks
- **camelCase**: Variables y funciones
- **PascalCase**: Componentes React
- **2 espacios**: IndentaciÃ³n
- **Punto y coma**: Al final de statements
- **Comillas simples**: Para strings

### CSS
- **CSS Modules**: Para scoped styles
- **camelCase**: Class names
- **Variables CSS**: Para valores reutilizables
- **Mobile First**: Responsive design

### Base de Datos
- **snake_case**: Nombres de tablas y columnas
- **Ãndices**: Para optimizaciÃ³n de queries
- **Constraints**: Para integridad de datos

## ğŸ”§ Herramientas de Desarrollo

### Linting y Formateo
- **ESLint**: Para JavaScript/React
- **Prettier**: Formateo de cÃ³digo
- **Vite**: Build tool y dev server

### Debugging
- **Console.log**: Para debugging bÃ¡sico
- **React DevTools**: Para debugging de componentes
- **MySQL Workbench**: Para debugging de BD

## ğŸ“± Responsive Design

### Breakpoints
- **Mobile**: < 768px
- **Tablet**: 768px - 1024px
- **Desktop**: > 1024px

### Componentes Responsive
- **Sidebar**: Colapsable en mobile
- **Tables**: Scroll horizontal en mobile
- **Forms**: Stack vertical en mobile
- **Modals**: Full screen en mobile

## ğŸ”„ Workflow de Desarrollo

### Flujo TÃ­pico
1. **Desarrollo**: Los servidores ya estÃ¡n corriendo automÃ¡ticamente
2. **Testing**: Pruebas manuales en navegador
3. **API Testing**: Usando archivos .http
4. **Database**: Consultas directas en MySQL
5. **Deployment**: PreparaciÃ³n para Vercel

### Hot Reload
- **Frontend**: Vite hot reload automÃ¡tico
- **Backend**: Node --watch autorestart
- **CSS**: Hot reload automÃ¡tico
- **API**: Restart automÃ¡tico con cambios

## ğŸš€ Deployment (Vercel)

### Frontend
- **el servidor siempre esta en marcha y se reinicia a cada cambio , no hacer un arranque nuevo**.
- **Build Command**: `pnpm build`
- **Output Directory**: `dist`
- **Environment Variables**: Configuradas en Vercel

### Backend
- **el servidor siempre esta en marcha y se reinicia a cada cambio , no hacer un arranque nuevo**.
- **Runtime**: Node.js
- **Database**: MySQL externo
- **Environment Variables**: Para conexiÃ³n BD
